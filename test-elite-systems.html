<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø¸Ø§Ù… Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ø®Ø¨Ø©</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e293b, #334155);
            color: white;
            padding: 20px;
            direction: rtl;
        }
        .test-panel {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #fbbf24;
        }
        button {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: black;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid #22c55e;
        }
        .error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid #ef4444;
        }
        #output {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>ğŸŒŸ Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø¸Ø§Ù… Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ø®Ø¨Ø© - Ø§Ù„Ø­Ø±Ø¨ ÙˆØ§Ù„Ù†Ø¸Ø§Ù…</h1>
    
    <div class="test-panel">
        <h3>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙ‡ÙŠØ¦Ø©</h3>
        <button onclick="testInitialization()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙ‡ÙŠØ¦Ø©</button>
        <button onclick="testEliteFields()">Ø§Ø®ØªØ¨Ø§Ø± Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ø®Ø¨Ø©</button>
        <button onclick="testTradeShip()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³ÙÙŠÙ†Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</button>
        <button onclick="testInvestmentCenter()">Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø±ÙƒØ² Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±</button>
        <button onclick="runAllTests()">ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</button>
    </div>

    <div class="test-panel">
        <h3>Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹ Ù„Ù„Ø£Ù†Ø¸Ù…Ø©</h3>
        <button onclick="quickTest()">Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹</button>
        <button onclick="clearOutput()">Ù…Ø³Ø­ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
    </div>

    <div id="output"></div>

    <script>
        let testOutput = document.getElementById('output');
        
        function log(message, isError = false) {
            const timestamp = new Date().toLocaleTimeString('ar-SA');
            const className = isError ? 'error' : 'status';
            testOutput.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            testOutput.scrollTop = testOutput.scrollHeight;
        }

        function clearOutput() {
            testOutput.innerHTML = '';
        }

        function testInitialization() {
            log('ğŸ”„ Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙ‡ÙŠØ¦Ø©...');
            
            try {
                // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø¨Ø³Ø·Ø©
                const allianceSystem = {
                    eliteFields: {
                        enabled: true,
                        fields: {
                            food: {
                                id: "elite_food",
                                name: "Ø­Ù‚Ù„ Ø§Ù„Ø·Ø¹Ø§Ù… Ø§Ù„Ù†Ø®Ø¨Ø©",
                                type: "food",
                                productionRate: 5000,
                                bonusMultiplier: 3,
                                gatherSpeed: 1.5,
                                loadBonus: 1.25,
                                protection: true,
                                requiredAlliance: true,
                                location: "territory",
                                color: 0x90EE90
                            }
                        },
                        currentGathering: {
                            active: false,
                            fieldId: null,
                            troops: {},
                            startTime: null,
                            endTime: null,
                            resources: {}
                        }
                    },
                    c15Farms: {
                        enabled: true,
                        farms: [
                            {
                                id: "food_farm_1",
                                name: "Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø·Ø¹Ø§Ù… C15",
                                specialization: "food",
                                dailyProduction: 1200000,
                                troops: { T2_Cavalry: 5000 },
                                requirement: "Alliance Member",
                                active: true
                            }
                        ]
                    },
                    tradeShip: {
                        enabled: true,
                        level: 1,
                        currentTrade: {
                            active: false,
                            fromKingdom: null,
                            toKingdom: null,
                            resources: {},
                            startTime: null,
                            duration: 0,
                            completionTime: null
                        }
                    },
                    investmentCenter: {
                        enabled: true,
                        level: 1,
                        currentInvestments: {
                            treasury: 0,
                            enterprise: 0,
                            empire: 0
                        }
                    }
                };
                
                log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ø§Ù„Ù Ø¨Ù†Ø¬Ø§Ø­');
                log(`ğŸ“Š Ø¹Ø¯Ø¯ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ø®Ø¨Ø©: ${Object.keys(allianceSystem.eliteFields.fields).length}`);
                log(`ğŸšœ Ø¹Ø¯Ø¯ Ù…Ø²Ø§Ø±Ø¹ C15: ${allianceSystem.c15Farms.farms.length}`);
                log('âœ… ØªÙ… Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø¨Ù†Ø¬Ø§Ø­');
                
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©: ${error.message}`, true);
            }
        }

        function testEliteFields() {
            log('ğŸ”„ Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ø®Ø¨Ø©...');
            
            try {
                // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ¬Ù…ÙŠØ¹ Ù…Ù† Ø­Ù‚Ù„ Ù†Ø®Ø¨Ø©
                const field = {
                    name: "Ø­Ù‚Ù„ Ø§Ù„Ø·Ø¹Ø§Ù… Ø§Ù„Ù†Ø®Ø¨Ø©",
                    type: "food",
                    productionRate: 5000,
                    bonusMultiplier: 3,
                    gatherSpeed: 1.5
                };
                
                const elapsedTime = 1800000; // 30 Ø¯Ù‚ÙŠÙ‚Ø©
                const gatheringMultiplier = Math.min(elapsedTime / 3600000, 1);
                const baseProduction = field.productionRate * field.bonusMultiplier;
                const gatheredResources = Math.floor(baseProduction * gatheringMultiplier);
                
                log(`ğŸŒ¾ Ø­Ù‚Ù„: ${field.name}`);
                log(`ğŸ“ˆ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ: ${field.productionRate}/Ø³Ø§Ø¹Ø©`);
                log(`âš¡ Ù…Ø¶Ø§Ø¹Ù Ø§Ù„Ù†Ø®Ø¨Ø©: ${field.bonusMultiplier}x`);
                log(`ğŸ“Š Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©: ${gatheredResources} ${field.type}`);
                log('âœ… ØªÙ… Ø§Ø®ØªØ¨Ø§Ø± Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ø®Ø¨Ø© Ø¨Ù†Ø¬Ø§Ø­');
                
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ø®Ø¨Ø©: ${error.message}`, true);
            }
        }

        function testTradeShip() {
            log('ğŸ”„ Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³ÙÙŠÙ†Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©...');
            
            try {
                const tradeShip = {
                    level: 1,
                    benefits: {
                        1: { tradeSpeed: 1.1, maxLoad: 10000 }
                    },
                    currentTrade: {
                        active: false
                    }
                };
                
                // Ù…Ø­Ø§ÙƒØ§Ø© Ø¨Ø¯Ø¡ ØªØ¬Ø§Ø±Ø©
                const resources = { gold: 5000, food: 3000 };
                const totalLoad = Object.values(resources).reduce((sum, amount) => sum + amount, 0);
                
                if (totalLoad <= tradeShip.benefits[tradeShip.level].maxLoad) {
                    log('ğŸš¢ Ø¨Ø¯Ø¡ ØªØ¬Ø§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©');
                    log(`ğŸ“¦ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©: ${totalLoad}`);
                    log(`âš¡ Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ¬Ø§Ø±Ø©: ${Math.round(tradeShip.benefits[tradeShip.level].tradeSpeed * 100)}%`);
                    log('âœ… ØªÙ… Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³ÙÙŠÙ†Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
                } else {
                    log('âŒ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© ØªØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰', true);
                }
                
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø³ÙÙŠÙ†Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©: ${error.message}`, true);
            }
        }

        function testInvestmentCenter() {
            log('ğŸ”„ Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø±ÙƒØ² Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±...');
            
            try {
                const investmentCenter = {
                    level: 1,
                    investmentTypes: {
                        treasury: {
                            name: "Ù…Ø®Ø²Ù† Ø§Ù„Ø°Ù‡Ø¨",
                            baseReturn: 0.05,
                            cost: 500,
                            maxInvestment: 100000
                        },
                        enterprise: {
                            name: "Ù…Ø´Ø±ÙˆØ¹ ØªØ¬Ø§Ø±ÙŠ",
                            baseReturn: 100,
                            cost: 1000,
                            maxInvestment: 500000
                        }
                    },
                    currentInvestments: {
                        treasury: 10000,
                        enterprise: 5000
                    }
                };
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ø§Ø¦Ø¯
                let totalReturn = 0;
                Object.keys(investmentCenter.currentInvestments).forEach(type => {
                    const investment = investmentCenter.currentInvestments[type];
                    const typeData = investmentCenter.investmentTypes[type];
                    totalReturn += investment * typeData.baseReturn;
                });
                
                log('ğŸ’° Ù…Ø±ÙƒØ² Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± - Ù…Ø³ØªÙˆÙ‰ 1');
                log(`ğŸ“ˆ Ø§Ø³ØªØ«Ù…Ø§Ø± Ù…Ø®Ø²Ù† Ø§Ù„Ø°Ù‡Ø¨: ${investmentCenter.currentInvestments.treasury}`);
                log(`ğŸ¢ Ø§Ø³ØªØ«Ù…Ø§Ø± Ù…Ø´Ø±ÙˆØ¹ ØªØ¬Ø§Ø±ÙŠ: ${investmentCenter.currentInvestments.enterprise}`);
                log(`ğŸ’µ Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${totalReturn.toFixed(2)}`);
                log('âœ… ØªÙ… Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø±ÙƒØ² Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­');
                
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ Ù…Ø±ÙƒØ² Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±: ${error.message}`, true);
            }
        }

        function quickTest() {
            log('âš¡ Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹ Ù„Ù„Ø£Ù†Ø¸Ù…Ø©...');
            testInitialization();
            testEliteFields();
            testTradeShip();
            testInvestmentCenter();
            log('ğŸ‰ ØªÙ… Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³Ø±ÙŠØ¹!');
        }

        function runAllTests() {
            log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª...');
            testInitialization();
            testEliteFields();
            testTradeShip();
            testInvestmentCenter();
            log('ğŸ‰ ØªÙ… Ø¥Ù†Ø¬Ø§Ø² Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!');
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('load', () => {
            log('ğŸŒŸ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ… ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø¸Ø§Ù… Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ø®Ø¨Ø©');
            log('ğŸ’¡ Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…Ø®ØªÙ„ÙØ©');
            setTimeout(quickTest, 1000);
        });
    </script>
</body>
</html>